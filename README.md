# æ·˜è´åº”ç”¨ - æµ‹è¯•é©±åŠ¨å¼€å‘é¡¹ç›®

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäºæµ‹è¯•é©±åŠ¨å¼€å‘(TDD)åŸåˆ™æ„å»ºçš„æ·˜è´åº”ç”¨é¡¹ç›®ï¼ŒåŒ…å«ç”¨æˆ·æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ã€‚é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œä¸¥æ ¼éµå¾ª"æµ‹è¯•å…ˆè¡Œ"çš„å¼€å‘ç†å¿µã€‚

## æŠ€æœ¯æ ˆ

### åç«¯
- **æ¡†æ¶**: Node.js + Express.js
- **æ•°æ®åº“**: SQLite
- **æµ‹è¯•æ¡†æ¶**: Jest + Supertest
- **å…¶ä»–**: CORS, JWT, bcrypt, express-rate-limit

### å‰ç«¯
- **æ¡†æ¶**: React + TypeScript
- **æ„å»ºå·¥å…·**: Vite
- **æµ‹è¯•æ¡†æ¶**: Vitest + React Testing Library
- **å…¶ä»–**: React Router DOM

## é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ routes/          # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ app.js           # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ test/
â”‚   â”‚   â”œâ”€â”€ models/          # æ¨¡å‹æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ routes/          # è·¯ç”±æµ‹è¯•
â”‚   â”‚   â””â”€â”€ integration/     # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ jest.config.js
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/      # Reactç»„ä»¶
â”‚   â”‚   â””â”€â”€ utils/           # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ test/
â”‚   â”‚   â”œâ”€â”€ components/      # ç»„ä»¶æµ‹è¯•
â”‚   â”‚   â””â”€â”€ e2e/             # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ verify-system.js         # ç³»ç»ŸéªŒè¯è„šæœ¬
â”œâ”€â”€ integration-test.js      # é›†æˆæµ‹è¯•è„šæœ¬
â””â”€â”€ README.md
```

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£…åç«¯ä¾èµ–
cd backend
npm install

# å®‰è£…å‰ç«¯ä¾èµ–
cd ../frontend
npm install
```

### 2. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨åç«¯æœåŠ¡ (ç«¯å£ 3000)
cd backend
npm start

# å¯åŠ¨å‰ç«¯æœåŠ¡ (ç«¯å£ 5173)
cd frontend
npm run dev
```

### 3. éªŒè¯ç³»ç»Ÿ

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œç³»ç»ŸéªŒè¯
node verify-system.js
```

## æµ‹è¯•æŒ‡å—

### ğŸš¨ é‡è¦ï¼šæµ‹è¯•è¶…æ—¶é…ç½®

æœ¬é¡¹ç›®é…ç½®äº†ä¸¥æ ¼çš„æµ‹è¯•è¶…æ—¶æ§åˆ¶ï¼Œç¡®ä¿æµ‹è¯•å¿«é€Ÿå¤±è´¥ï¼š

- **å‰ç«¯æµ‹è¯•è¶…æ—¶**: 10ç§’
- **åç«¯æµ‹è¯•è¶…æ—¶**: 10ç§’
- **ç³»ç»ŸéªŒè¯è¶…æ—¶**: 5ç§’
- **é›†æˆæµ‹è¯•è¶…æ—¶**: 10ç§’

### è¿è¡Œæµ‹è¯•

#### åç«¯æµ‹è¯•

```bash
cd backend

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
npm test -- test/models/database.test.js
npm test -- test/routes/auth.test.js
npm test -- test/integration/api.test.js

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

#### å‰ç«¯æµ‹è¯•

```bash
cd frontend

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
npm test -- test/components/LoginForm.test.tsx
npm test -- test/components/RegisterForm.test.tsx
npm test -- test/e2e/user-flows.test.tsx

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

#### ç³»ç»ŸéªŒè¯

```bash
# éªŒè¯ç³»ç»Ÿå®Œæ•´æ€§
node verify-system.js

# è¿è¡Œé›†æˆæµ‹è¯•
node integration-test.js
```

### æµ‹è¯•è¦†ç›–èŒƒå›´

#### åç«¯æµ‹è¯•è¦†ç›–
- âœ… æ•°æ®åº“æ“ä½œ (DB-FindUserByPhone, DB-CreateUser, DB-CreateVerificationCode, etc.)
- âœ… APIç«¯ç‚¹ (å‘é€éªŒè¯ç , ç”¨æˆ·æ³¨å†Œ, ç”¨æˆ·ç™»å½•)
- âœ… é”™è¯¯å¤„ç†å’ŒéªŒè¯
- âœ… é›†æˆæµ‹è¯•å’ŒAPIè°ƒç”¨é“¾
- âœ… CORSå’Œå®‰å…¨æ€§é…ç½®

#### å‰ç«¯æµ‹è¯•è¦†ç›–
- âœ… ç»„ä»¶æ¸²æŸ“å’ŒUIå…ƒç´ 
- âœ… ç”¨æˆ·äº¤äº’å’Œè¡¨å•éªŒè¯
- âœ… çŠ¶æ€ç®¡ç†å’Œç”Ÿå‘½å‘¨æœŸ
- âœ… é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€
- âœ… ç«¯åˆ°ç«¯ç”¨æˆ·æµç¨‹

#### ç³»ç»Ÿæµ‹è¯•è¦†ç›–
- âœ… æœåŠ¡å¥åº·æ£€æŸ¥
- âœ… å‰åç«¯é€šä¿¡
- âœ… æ•°æ®åº“è¿æ¥
- âœ… APIç«¯ç‚¹å¯ç”¨æ€§
- âœ… å®Œæ•´ç”¨æˆ·æµç¨‹

## APIæ¥å£æ–‡æ¡£

### å‘é€éªŒè¯ç 
```
POST /api/auth/send-code
Content-Type: application/json

{
  "phone": "13800138001",
  "type": "register" | "login"
}
```

### ç”¨æˆ·æ³¨å†Œ
```
POST /api/auth/register
Content-Type: application/json

{
  "phone": "13800138001",
  "code": "123456"
}
```

### ç”¨æˆ·ç™»å½•
```
POST /api/auth/login
Content-Type: application/json

{
  "phone": "13800138001",
  "code": "123456"
}
```

### å¥åº·æ£€æŸ¥
```
GET /api/health
```

## æµ‹è¯•æ•°æ®

### æµ‹è¯•ç”¨æˆ·
- æ‰‹æœºå·æ ¼å¼: 138xxxxxxxx
- æµ‹è¯•éªŒè¯ç : 123456 (å¼€å‘ç¯å¢ƒ)

### æµ‹è¯•åœºæ™¯
1. **æ­£å¸¸æµç¨‹**: å‘é€éªŒè¯ç  â†’ æ³¨å†Œ/ç™»å½• â†’ è·å–Token
2. **é”™è¯¯å¤„ç†**: æ— æ•ˆæ‰‹æœºå·ã€é”™è¯¯éªŒè¯ç ã€é‡å¤æ³¨å†Œç­‰
3. **è¾¹ç•Œæ¡ä»¶**: è¾“å…¥é•¿åº¦é™åˆ¶ã€è¶…æ—¶å¤„ç†ç­‰

## å¼€å‘è§„èŒƒ

### æµ‹è¯•é©±åŠ¨å¼€å‘æµç¨‹
1. **çº¢è‰²é˜¶æ®µ**: ç¼–å†™å¤±è´¥çš„æµ‹è¯•ç”¨ä¾‹
2. **ç»¿è‰²é˜¶æ®µ**: ç¼–å†™æœ€å°‘ä»£ç ä½¿æµ‹è¯•é€šè¿‡
3. **é‡æ„é˜¶æ®µ**: ä¼˜åŒ–ä»£ç ç»“æ„å’Œæ€§èƒ½

### ä»£ç è´¨é‡è¦æ±‚
- æµ‹è¯•è¦†ç›–ç‡ > 90%
- æ‰€æœ‰æµ‹è¯•å¿…é¡»é€šè¿‡
- ä»£ç ç¬¦åˆESLintè§„èŒƒ
- æäº¤å‰å¿…é¡»è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶

### Gitå·¥ä½œæµ
```bash
# å¼€å‘æ–°åŠŸèƒ½
git checkout -b feature/new-feature

# è¿è¡Œæµ‹è¯•ç¡®ä¿è´¨é‡
npm test

# æäº¤ä»£ç 
git add .
git commit -m "feat: add new feature with tests"

# åˆå¹¶åˆ°ä¸»åˆ†æ”¯å‰å†æ¬¡éªŒè¯
node verify-system.js
node integration-test.js
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æµ‹è¯•è¶…æ—¶**
   - æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨
   - ç¡®è®¤æ•°æ®åº“è¿æ¥æ­£å¸¸
   - éªŒè¯ç½‘ç»œè¿æ¥

2. **ä¾èµ–å®‰è£…å¤±è´¥**
   ```bash
   # æ¸…ç†ç¼“å­˜é‡æ–°å®‰è£…
   rm -rf node_modules package-lock.json
   npm install
   ```

3. **ç«¯å£å†²çª**
   - åç«¯é»˜è®¤ç«¯å£: 3000
   - å‰ç«¯é»˜è®¤ç«¯å£: 5173
   - å¯åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹

4. **æ•°æ®åº“é—®é¢˜**
   - SQLiteæ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»º
   - æµ‹è¯•ä½¿ç”¨ç‹¬ç«‹çš„æµ‹è¯•æ•°æ®åº“
   - å¯æ‰‹åŠ¨åˆ é™¤database.sqliteé‡æ–°åˆå§‹åŒ–

### è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹è¯¦ç»†æµ‹è¯•è¾“å‡º**
   ```bash
   npm test -- --verbose
   ```

2. **è¿è¡Œå•ä¸ªæµ‹è¯•**
   ```bash
   npm test -- --testNamePattern="specific test name"
   ```

3. **æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡**
   ```bash
   npm run test:coverage
   open coverage/lcov-report/index.html
   ```

## è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. ç¼–å†™æµ‹è¯•ç”¨ä¾‹
4. å®ç°åŠŸèƒ½ä»£ç 
5. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
6. æäº¤Pull Request

## è®¸å¯è¯

MIT License

---

**è®°ä½ï¼šæµ‹è¯•ä¸ä»…æ˜¯éªŒè¯ä»£ç æ­£ç¡®æ€§çš„å·¥å…·ï¼Œæ›´æ˜¯è®¾è®¡å’Œæ–‡æ¡£çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼**